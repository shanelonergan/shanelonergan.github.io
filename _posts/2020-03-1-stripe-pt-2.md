---
layout: post
title:  "Adding the Stripe API to your React-Rails application"
date:   2020-2-30
description: 'Part 2: Server-Side'
img: stripe.png
tags: [programming, terminal, bash] # add tag
---
---

Welcome to Part 2 of my Stripe API series for React and Rails! If you haven't yet read part one, you can find it [here](https://shanelonergan.github.io/terminal-pt-1/). In part two we will be walking through building the server-side integration of the Stripe API. In part 1, we used a Stripe Checkout to securely collect the user's payment information. This process was handled by Stripe, and returned us a Token which represents that sensitive information. Then we sent that Token to our back-end where we will actually charge the User based on their item/s. In this post we will build out that back-end functionality, and the end result will be a functional Stripe payment processing system.

## Table of Contents

- [Table of Contents](#table-of-contents)
- [Set Up](#set-up)
- [Charge Controller](#charge-controller)

## Set Up

Just like in our front-end, we are going to want to have a way to safely handle our environmental variables. There are many ways to do this, including a built in rails function, but for consistency we are going to use Dotenv again. We are also going to be receiving requests from our front-end, so we will need to make sure our CORS is properly set up. First, we want to head to our gem file, and uncomment the gem `'rack/cors'`. Then we want to add the gems `'dotenv'` and `'stripe'`. Next, we want to head to 'config/initializers/cors.rb'. For development, we want to allow requests from all origins. Your final `coors.rb` file should look something like this:

```ruby
Rails.application.config.middleware.insert_before 0, Rack::Cors do
  allow do
    origins '*'

    resource '*',
      headers: :any,
      methods: [:get, :post, :put, :patch, :delete, :options, :head]
  end
end
```

## Charge Controller

- dotenv
- cors
- charge controller
- route
- params
